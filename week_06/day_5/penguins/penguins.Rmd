---
title: "R Notebook"
output: html_notebook
---

```{r}
library(palmerpenguins)
library(tidyverse)
library(e1071)
library(infer)

penguins <- palmerpenguins::penguins 
```
We are interested in how bill length differ between the three species of penguin (Adelie, Chinstrap & Gentoo) in this dataset. 

1. Explore the dataset using visualisations, and keep in mind the question youâ€™re trying to answer above.

- The histogram shows the bill length and count of penguins separated by species of Adelie, Chinstrap and Gentoo. 
- The separate graphs shows the individual count of each species - you can see that in the study Adelie has the highest count, Gentoo has the second highest count and Chinstrap has the lowest count number. 
- The bill length of each species shows that on average Adelie penguins has the lowest bill length with both Chinstrap and Gentoo having higher bill lengths.
- The longest bill length is found in the Gentoo species and the lowest bill length is found in the Adeline species.

```{r}
penguins <- penguins %>% 
  filter(!is.na(bill_length_mm)) 

penguins %>% 
  ggplot(aes(y = bill_length_mm)) +
  geom_histogram(col = "white") +
  facet_wrap(~ species) +
  labs(title = "Penguin Bill Length by Species\n",
       x = "Count",
       y = "Bill Length")
```
2. Calculate the following summary statistics to describe bill length for each species:
measures of centrality (mean & median)
spread (standard deviation)
skewness (you can use the skewness() function from the e1071 package)

- The results below show that the mean length of the Chinstrap species is the highest, as is the median.
- The sd is the lowest for Adelie followed by Gentoo and then Chinstrap
- The skewness is fairly symmetrical left skewed for Adelie, moderately left skewed for Gentoo and fairly symmetrical right skewed for Chinstrap


```{r}
# mean bill length for each species

penguins %>% 
  group_by(species) %>% 
  summarise(mean_bill_length = mean(bill_length_mm))
```

```{r}
# median bill length for each species

penguins %>% 
  group_by(species) %>% 
  summarise(median_bill_length = median(bill_length_mm))
```

```{r}
# spread (standard deviation) of each species

penguins %>% 
  group_by(species) %>% 
  summarise(sd = sd(bill_length_mm))
```

```{r}
# skewness of each species

penguins %>% 
  group_by(species) %>% 
  summarise(skewness = skewness(bill_length_mm, type = 1))
```

3. Perform a suitable hypothesis test to check whether the mean bill length of Gentoo is significantly longer than the mean bill length of Adelie.


H0: gentoo_mean_length - adelie_mean_length > 0
Ha: gentoo_mean_length - adelie_mean_length = 0

```{r}
penguin_filter <- penguins %>% 
  filter(species != "Chinstrap")

penguin_filter
```

```{r}
penguin_filter %>% 
  group_by(species) %>% 
  summarise(n())
```

```{r}
penguin_filter %>% 
  ggplot(aes(x = species, y = bill_length_mm)) +
  geom_boxplot()
```

```{r}
null_distribution <- penguin_filter %>% 
  specify(response = bill_length_mm, explanatory = species) %>% 
  hypothesise(null = ) %>% 
  generate(reps = 1000, type = "permute") %>% 
  calculate(stat = "diff in means", order = c("Adelie", "Gentoo"))

null_distribution
```

```{r}
observed_stat <- penguin_filter %>% 
  specify(response = bill_length_mm, explanatory = species) %>%
  calculate(stat = "diff in means", order = c("Adelie", "Gentoo"))

observed_stat
```

```{r}
null_distribution %>% 
  visualise(bins = 15) +
  shade_p_value(obs_stat = observed_stat, direction = "bootstrap")
```

```{r}
null_distribution %>% 
  get_p_value(obs_stat = observed_stat, direction = "bootstrap")
```

```{r}
p_value == 0
```

